#include <bits/stdc++.h>
#include <cstdlib>
using namespace std;
#define int long long

int n,m;
int max1=0,max2=0,min1=1000,min2=1000;
int ans[100002];
vector<int>d[1001];
int f[1002][1002],mk[1001];
int dx[4]={1,-1,0,0}, dy[4]={0,0,1,-1};
char srr[1002][1002];
void dfs(int a,int b,int z,int lll){
	if(a<0||a>=n||b<0||b>=m||f[a][b]!=-1||srr[a][b]-'0'!=z){
		return;
	}
	f[a][b]=lll;
	ans[lll]++;
	dfs(a-1, b, !z, lll); 
	dfs(a+1, b, !z, lll); 
	dfs(a, b-1, !z, lll); 
	dfs(a, b+1, !z, lll);
}
signed main(){
	cin>>n>>m;
	for(int i=0;i<n;i++){
		cin>>srr[i];
	}
	memset(f,-1,sizeof(f));
	for(int i=0;i<m;i++){
		int p,q;
		cin>>p>>q;
		p--,q--;
		if(f[p][q]==-1){
			dfs(p,q,srr[p][q]-'0',i);
		}
		else ans[i]=ans[f[p][q]];
	}
	for (int i=0;i<m;i++)
		cout<<ans[i]<<'\n'; 
}        
